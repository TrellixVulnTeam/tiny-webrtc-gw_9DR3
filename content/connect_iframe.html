<html>
<body onload='connectIFrameOnLoad(this)'>
<select id='joinMode' name='joinMode'>
  <option value='broadcast'>broadcast</option>
  <option value='watch'>watch</option>
</select>
<button id='joinButton' onClick='onOK(this)'>
Join
</button>
<button id='leaveButton' onClick='onLeave(this)'>
Leave
</button>
</body>

<script src='src/js/adapter.js'></script>
<script src='src/js/lib/ga.js'></script>
<script src='js/popup.js'></script>
<script src='js/peers.js'></script>
<script src='js/peerdynamic.js'></script>
<script src='js/broadcast.js'></script>
<script language='javascript'>

function onJoin() {
  var parentDoc = window.parent.document;
  var joinMode = document.getElementById('joinMode');
  var roomElem = parentDoc.getElementById('roomName');

  var vidElem = joinMode.value == 'broadcast' ?
    parentDoc.getElementById('localVideo') :
    parentDoc.getElementById('videoMain');
  var vidElemButton = parentDoc.getElementById(vidElem.id == 'videoMain' ? 'videoMainButton' : 'localVideoButton')

  var f = function() {
    joinIframeOnLoadBroadcast(joinMode);
  }

  connectVideoIframe(vidElem, f, vidElem.value);
}

function onOK(okButton) {
  onJoin();
}

function onLeave(leaveButton)
{
  leaveButton.disabled = true;
  window.parent.onLeave();
}
</script>

</html>
